local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Workspace = game:GetService("Workspace")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local LocalPlayer = Players.LocalPlayer
local Remotes = ReplicatedStorage and ReplicatedStorage:FindFirstChild("Remotes")
local Functions = Remotes and Remotes:FindFirstChild("Functions")
local Events = Remotes and Remotes:FindFirstChild("Events")
local CombatRemote = Functions and Functions:FindFirstChild("CombatRF")
local CollectionRemote = Functions and Functions:FindFirstChild("CollectionRF")
local HatchRemote = Events and Events:FindFirstChild("HatchEggEvent")
local PlantRemote = Events and Events:FindFirstChild("PlantEggEvent")
local FeedRemote = Events and Events:FindFirstChild("FeedEggEvent")
local SacrificeRemote = Functions and Functions:FindFirstChild("SacrificeFunction")
local ZonesRF = Functions and Functions:FindFirstChild("ZonesRF")

local active = false
local eggsSelected = {}
local bossEnabled = {}
local activeBosses = {}
local jumpConnection = nil
local jumpCount = 0
local startDebounce = false

-- Sistema de cache otimizado
local cache = {
    pets = { value = nil, lastUpdate = 0 },
    nests = { value = nil, lastUpdate = 0 },
    zones = {
        boss = {},
        enemy = {},
        food = {},
        egg = {}
    }
}

-- Pool de conexões
local connections = {}

local function safeConnect(event, callback)
    local key = tostring(event)
    if connections[key] then
        connections[key]:Disconnect()
    end
    connections[key] = event:Connect(callback)
end

-- Limitador de chamadas global
local callLimiter = {
    count = 0,
    lastReset = os.clock(),
    maxPerSecond = 3
}

local function canCall()
    local now = os.clock()
    if now - callLimiter.lastReset >= 1 then
        callLimiter.count = 0
        callLimiter.lastReset = now
    end
    if callLimiter.count < callLimiter.maxPerSecond then
        callLimiter.count = callLimiter.count + 1
        return true
    end
    return false
end

-- Detector de lag
local lagDetector = {
    lastFrameTime = os.clock(),
    lagCount = 0,
    ecoMode = false
}

RunService.Heartbeat:Connect(function()
    local now = os.clock()
    local dt = now - lagDetector.lastFrameTime
    lagDetector.lastFrameTime = now
    
    if dt > 0.1 then
        lagDetector.lagCount = lagDetector.lagCount + 1
    else
        lagDetector.lagCount = 0
    end
    
    if lagDetector.lagCount > 5 and not lagDetector.ecoMode then
        lagDetector.ecoMode = true
        config.bossSpeed = 3
        config.enemiesSpeed = 3
        config.foodSpeed = 3
    elseif lagDetector.lagCount == 0 and lagDetector.ecoMode then
        lagDetector.ecoMode = false
        config.bossSpeed = 2
        config.enemiesSpeed = 2
        config.foodSpeed = 2
    end
end)

-- Detector de inatividade
local lastPlayerMove = os.clock()
safeConnect(LocalPlayer.CharacterAdded, function(char)
    local root = char:WaitForChild("HumanoidRootPart")
    safeConnect(root:GetPropertyChangedSignal("Position"), function()
        lastPlayerMove = os.clock()
    end)
end)

local function isPlayerActive()
    return os.clock() - lastPlayerMove < 30
end

-- Coletor de lixo automático
task.spawn(function()
    while true do
        task.wait(300)
        if not active then
            collectgarbage("collect")
            cache.pets = { value = nil, lastUpdate = 0 }
            cache.nests = { value = nil, lastUpdate = 0 }
        end
    end
end)

local bossZoneMap = {
    Naga = "Zone2B1",
    ["Lava Monster"] = "Zone5B1",
    ["Tiki Monster"] = "Zone10B1",
    ["The Frozen Ancient"] = "Zone12B1",
    ["The Big 100M"] = "Zone12B3",
    ["The Ethereal Everia"] = "Zone12B2",
    ["Hornet Boss"] = "SummerEventZoneB1",
    ["The Ice Serpent"] = "WinterEventZoneB1",
    ["Great Sphinx"] = "ElementEventZoneB1",
}

local enemyList = {
    { name = "Summer", zone = "SummerEventZone", attackAll = true },
    { name = "Winter", zone = "WinterEventZone", attackAll = true },
    { name = "Sphinx (Evil Eagle)", zone = "ElementEventZone1", enemy = "Evil Eagle", needsRequest = true },
    { name = "Cursed Mummy", zone = "Zone2", enemy = "Cursed Mummy", needsRequest = true },
    { name = "Crazy Unicorn", zone = "Zone5", enemy = "Crazy Unicorn", needsRequest = true },
    { name = "Terror Tree", zone = "Zone10", enemy = "Terror Tree", needsRequest = true },
    { name = "Draco's Guard", zone = "Zone12", enemy = "Draco's Guard", needsRequest = true },
}

local enemyEnabled = {}
for i, enemy in ipairs(enemyList) do
    enemyEnabled[i] = false
end

local foodZones = {
    { name = "Crystal Food (Zone12.1)", zone = "Zone12.1", enabled = false },
    { name = "Draco Food (Zone12)", zone = "Zone12", enabled = false },
}

local config = {
    farmBosses = false,
    bossSpeed = 2,
    farmEnemies = false,
    enemiesSpeed = 2,
    farmFood = false,
    foodSpeed = 2,
    sacrificeQueen = false,
    sacrificeKing = false,
    sacrificeFrozen = false,
    sacrificeWalrus = false,
    sacrificeFennec = false,
    sacrificeMystic = false,
    doubleJump = false,
    wallspeed = 16,
}

local bossList = {
    "Naga", "Lava Monster", "Tiki Monster",
    "The Frozen Ancient", "The Big 100M", "The Ethereal Everia",
    "Hornet Boss", "The Ice Serpent", "Great Sphinx"
}
for _, name in ipairs(bossList) do bossEnabled[name] = true end

local zoneList = {
    "SummerEvent1", "WinterEvent1", "EleEgg1", "6", "4", "15", "10", "27",
    "30", "11", "34", "12.1", "1", "3", "7", "8", "9", "12", "13", "14",
    "Boss1", "Boss2", "Boss4",
    "SummerEventZone", "WinterEventZone", "Zone12.1", "ElementEventZone1",
    "Zone2", "Zone5", "Zone10", "Zone12",
    "Zone2B1", "Zone5B1", "Zone10B1", "Zone12B1", "Zone12B3", "Zone12B2",
    "SummerEventZoneB1", "WinterEventZoneB1", "ElementEventZoneB1"
}
for _, z in ipairs(zoneList) do
    local success, result = pcall(function()
        return Workspace.Zones:FindFirstChild(z)
    end)
    if success and result then
        cache.zones.egg[z] = result
        cache.zones.boss[z] = result
        cache.zones.enemy[z] = result
        cache.zones.food[z] = result
    end
end

local function getZone(type, name)
    return cache.zones[type] and cache.zones[type][name]
end

local function getPets()
    if not cache.pets.value or os.clock() - cache.pets.lastUpdate > 2 then
        if LocalPlayer.Character then
            local pets = LocalPlayer.Character:FindFirstChild("Pets")
            cache.pets.value = pets and pets:GetChildren() or {}
        else
            cache.pets.value = {}
        end
        cache.pets.lastUpdate = os.clock()
    end
    return cache.pets.value
end

local function getNests()
    if not cache.nests.value or os.clock() - cache.nests.lastUpdate > 10 then
        cache.nests.value = Workspace:FindFirstChild("Nests")
        cache.nests.lastUpdate = os.clock()
    end
    return cache.nests.value
end

safeConnect(LocalPlayer.CharacterAdded, function()
    cache.pets.lastUpdate = 0
end)

if LocalPlayer.Character then
    pcall(function()
        safeConnect(LocalPlayer.Character.ChildAdded, function(child)
            if child.Name == "Pets" then
                cache.pets.lastUpdate = 0
            end
        end)
    end)
end

local function attackWithMultiplePets(enemy)
    if not canCall() then return end
    local pets = getPets()
    if #pets == 0 then return end
    for i = 1, math.min(5, #pets) do
        pcall(CombatRemote.InvokeServer, CombatRemote, "AttackEnemy", enemy, pets[i])
    end
end

local function attackEnemy(zoneName, enemyName, needsRequest)
    if not canCall() then return end
    if needsRequest then
        pcall(ZonesRF.InvokeServer, ZonesRF, "RequestZoneMap", zoneName)
        task.wait(0.2)
    end
    local zone = getZone("enemy", zoneName)
    if zone and zone:FindFirstChild("Enemies") then
        local enemy = zone.Enemies:FindFirstChild(enemyName)
        if enemy then
            attackWithMultiplePets(enemy)
        end
    end
end

local function attackAllEnemies(zoneName, needsRequest)
    if not canCall() then return end
    if needsRequest then
        pcall(ZonesRF.InvokeServer, ZonesRF, "RequestZoneMap", zoneName)
        task.wait(0.2)
    end
    local zone = getZone("enemy", zoneName)
    if zone and zone:FindFirstChild("Enemies") then
        local enemies = zone.Enemies:GetChildren()
        for _, enemy in ipairs(enemies) do
            attackWithMultiplePets(enemy)
            task.wait(0.1)
        end
    end
end

local function attackBosses()
    if not canCall() or #activeBosses == 0 then return end
    local pets = getPets()
    if #pets == 0 then return end
    local idx = 1
    for _, boss in ipairs(activeBosses) do
        if boss and boss.Parent then
            pcall(CombatRemote.InvokeServer, CombatRemote, "AttackEnemy", boss, pets[idx])
            idx = idx % #pets + 1
            task.wait(0.2)
        end
    end
end

local function attackEnemies()
    if not canCall() then return end
    for idx, enemy in ipairs(enemyList) do
        if enemyEnabled[idx] then
            if enemy.attackAll then
                attackAllEnemies(enemy.zone, enemy.needsRequest)
            else
                attackEnemy(enemy.zone, enemy.enemy, enemy.needsRequest)
            end
            task.wait(0.2)
        end
    end
end

local function collectFood()
    if not canCall() then return end
    for _, foodZone in ipairs(foodZones) do
        if foodZone.enabled then
            local zone = getZone("food", foodZone.zone)
            if zone and zone:FindFirstChild("FoodSpawns") then
                local foods = zone.FoodSpawns:GetChildren()
                for _, f in ipairs(foods) do
                    local pets = getPets()
                    for i = 1, math.min(5, #pets) do
                        pcall(CollectionRemote.InvokeServer, CollectionRemote, "CollectFood", f, pets[i])
                        task.wait(0.1)
                    end
                end
            end
        end
    end
end

local function mainWorker()
    while active do
        if config.farmBosses then
            attackBosses()
        end
        
        task.wait(0.3)
        
        if config.farmEnemies then
            attackEnemies()
        end
        
        task.wait(0.3)
        
        if config.farmFood then
            collectFood()
        end
        
        local waitTime = config.bossSpeed
        if not isPlayerActive() then
            waitTime = waitTime * 2
        end
        task.wait(waitTime)
    end
end

local sacrificeLoopActive = {
    queen = false,
    king = false,
    frozen = false,
    walrus = false,
    fennec = false,
    mystic = false
}
local sacrificeThreads = {}

local function doSacrifice(petName)
    if not canCall() then return end
    local success = pcall(function()
        SacrificeRemote:InvokeServer("SacrificeWell", petName)
    end)
    if success then
        game:GetService("StarterGui"):SetCore("SendNotification", {
            Title = "Sacrifice",
            Text = petName .. " sacrificed!",
            Duration = 2
        })
    end
    return success
end

local function toggleSacrificeLoop(petName, enable)
    local key = petName:lower():gsub(" ", "")
    if enable then
        if sacrificeThreads[key] then
            task.cancel(sacrificeThreads[key])
            sacrificeThreads[key] = nil
        end
        sacrificeThreads[key] = task.spawn(function()
            pcall(ZonesRF.InvokeServer, ZonesRF, "RequestZoneMap", "SummerEventZone")
            pcall(ZonesRF.InvokeServer, ZonesRF, "RequestZoneMap", "ElementEventZone1")
            task.wait(1)
            while active and sacrificeLoopActive[key] do
                doSacrifice(petName)
                task.wait(5)
            end
        end)
    else
        if sacrificeThreads[key] then
            task.cancel(sacrificeThreads[key])
            sacrificeThreads[key] = nil
        end
    end
end

local function stopAllSacrificeLoops()
    for _, thread in pairs(sacrificeThreads) do
        task.cancel(thread)
    end
    sacrificeThreads = {}
    sacrificeLoopActive.queen = false
    sacrificeLoopActive.king = false
    sacrificeLoopActive.frozen = false
    sacrificeLoopActive.walrus = false
    sacrificeLoopActive.fennec = false
    sacrificeLoopActive.mystic = false
end

local function scanBosses()
    if not config.farmBosses then return end
    local newActive = {}
    for _, name in ipairs(bossList) do
        if bossEnabled[name] then
            local zone = getZone("boss", bossZoneMap[name])
            if zone and zone:FindFirstChild("Enemies") then
                local enemy = zone.Enemies:FindFirstChild(name)
                if enemy then
                    table.insert(newActive, enemy)
                end
            end
        end
    end
    activeBosses = newActive
end

local function bossScanLoop()
    while active do
        scanBosses()
        task.wait(15)
    end
end

local function stopAllThreads()
    activeBosses = {}
end

local function start()
    if active then return end
    active = true
    scanBosses()
    task.spawn(mainWorker)
    task.spawn(bossScanLoop)
end

local function stop()
    active = false
    stopAllThreads()
    task.wait(1)
end

local win = Rayfield:CreateWindow({
    Name = "Maveryk Hub - Ultra Otimizado",
    LoadingTitle = "Loading...",
    LoadingSubtitle = "Anti-Crash | Anti-Lag | Eco Mode",
    ConfigurationSaving = { Enabled = true, FolderName = "MaverykHub", FileName = "Config" },
    Theme = "Dark"
})

local mainTab = win:CreateTab("Main")
mainTab:CreateSection("Control")
mainTab:CreateButton({ Name = "Start Farming", Callback = start })
mainTab:CreateButton({ Name = "Stop Farming", Callback = stop })

mainTab:CreateSection("Status")
local statusLabel = mainTab:CreateLabel("Status: Stopped")
local bossStatus = mainTab:CreateLabel("Bosses: OFF")
local enemyStatus = mainTab:CreateLabel("Enemies: OFF")
local foodStatus = mainTab:CreateLabel("Food: OFF")
local sacrificeStatus = mainTab:CreateLabel("Sacrifice: OFF")
local miscStatus = mainTab:CreateLabel("Misc: OFF")
local ecoStatus = mainTab:CreateLabel("Eco Mode: OFF")

task.spawn(function()
    while true do
        task.wait(0.5)
        if active then
            statusLabel:Set("Status: Active")
            bossStatus:Set("Bosses: " .. (config.farmBosses and "ON" or "OFF"))
            local anyEnemy = false
            for _, enabled in pairs(enemyEnabled) do
                if enabled then anyEnemy = true break end
            end
            enemyStatus:Set("Enemies: " .. (anyEnemy and "ON" or "OFF"))
            local anyFood = false
            for _, foodZone in ipairs(foodZones) do
                if foodZone.enabled then anyFood = true break end
            end
            foodStatus:Set("Food: " .. (anyFood and "ON" or "OFF"))
            local sacOn = sacrificeLoopActive.queen or sacrificeLoopActive.king or sacrificeLoopActive.frozen or sacrificeLoopActive.walrus or sacrificeLoopActive.fennec or sacrificeLoopActive.mystic
            sacrificeStatus:Set("Sacrifice: " .. (sacOn and "ON" or "OFF"))
            miscStatus:Set("Misc: " .. (config.doubleJump and "ON" or "OFF"))
            ecoStatus:Set("Eco Mode: " .. (lagDetector.ecoMode and "ON" or "OFF"))
        else
            statusLabel:Set("Status: Stopped")
            bossStatus:Set("Bosses: OFF")
            enemyStatus:Set("Enemies: OFF")
            foodStatus:Set("Food: OFF")
            sacrificeStatus:Set("Sacrifice: OFF")
            miscStatus:Set("Misc: OFF")
            ecoStatus:Set("Eco Mode: OFF")
        end
    end
end)

mainTab:CreateSection("Credits")
mainTab:CreateLabel("developed by Maveryk1t")
mainTab:CreateLabel("yt: Maveryk1t")
mainTab:CreateLabel("discord: knzd1")

local enemiesTab = win:CreateTab("Enemies")
enemiesTab:CreateSection("Enemy Farming")
enemiesTab:CreateToggle({ Name = "Enable Enemies", CurrentValue = config.farmEnemies, Callback = function(v) config.farmEnemies = v end })
enemiesTab:CreateToggle({ Name = "Enable All Enemies", CurrentValue = false, Callback = function(v)
    for i = 1, #enemyList do
        enemyEnabled[i] = v
    end
end })

enemiesTab:CreateSection("Event Enemies")
enemiesTab:CreateToggle({ Name = "Summer (All)", CurrentValue = enemyEnabled[1], Callback = function(v) enemyEnabled[1] = v end })
enemiesTab:CreateToggle({ Name = "Winter (All)", CurrentValue = enemyEnabled[2], Callback = function(v) enemyEnabled[2] = v end })
enemiesTab:CreateToggle({ Name = "Sphinx (Evil Eagle)", CurrentValue = enemyEnabled[3], Callback = function(v) enemyEnabled[3] = v end })

enemiesTab:CreateSection("Desert")
enemiesTab:CreateToggle({ Name = "Cursed Mummy", CurrentValue = enemyEnabled[4], Callback = function(v) enemyEnabled[4] = v end })

enemiesTab:CreateSection("Sky")
enemiesTab:CreateToggle({ Name = "Crazy Unicorn", CurrentValue = enemyEnabled[5], Callback = function(v) enemyEnabled[5] = v end })

enemiesTab:CreateSection("Tiki")
enemiesTab:CreateToggle({ Name = "Terror Tree", CurrentValue = enemyEnabled[6], Callback = function(v) enemyEnabled[6] = v end })

enemiesTab:CreateSection("Draco")
enemiesTab:CreateToggle({ Name = "Draco's Guard", CurrentValue = enemyEnabled[7], Callback = function(v) enemyEnabled[7] = v end })

enemiesTab:CreateSection("Settings")
enemiesTab:CreateSlider({ Name = "Speed (s)", Range = {1, 5}, Increment = 0.1, Suffix = "s", CurrentValue = config.enemiesSpeed, Callback = function(v) config.enemiesSpeed = v end })
enemiesTab:CreateLabel("5 pets per enemy attack")
enemiesTab:CreateLabel("Eco mode dobra o tempo se inativo")

local foodTab = win:CreateTab("Food")
foodTab:CreateSection("Food Zones")
foodTab:CreateToggle({ Name = "Enable Food", CurrentValue = config.farmFood, Callback = function(v) config.farmFood = v end })
foodTab:CreateLabel("Select which zones to farm:")

foodTab:CreateToggle({ 
    Name = foodZones[1].name, 
    CurrentValue = foodZones[1].enabled, 
    Callback = function(v) foodZones[1].enabled = v end 
})

foodTab:CreateToggle({ 
    Name = foodZones[2].name, 
    CurrentValue = foodZones[2].enabled, 
    Callback = function(v) foodZones[2].enabled = v end 
})

foodTab:CreateSection("Settings")
foodTab:CreateLabel("• 5 pets per food item")
foodTab:CreateSlider({ Name = "Speed (s)", Range = {1, 5}, Increment = 0.1, Suffix = "s", CurrentValue = config.foodSpeed, Callback = function(v) config.foodSpeed = v end })
foodTab:CreateLabel("Eco mode dobra o tempo se inativo")

local bossTab = win:CreateTab("Bosses")
bossTab:CreateSection("Boss Control")
bossTab:CreateToggle({ Name = "Enable Boss Farming", CurrentValue = config.farmBosses, Callback = function(v) config.farmBosses = v end })
bossTab:CreateToggle({ Name = "Enable All Bosses", CurrentValue = true, Callback = function(v)
    for _, name in ipairs(bossList) do bossEnabled[name] = v end
end })
bossTab:CreateSlider({ Name = "Speed (s)", Range = {1, 5}, Increment = 0.1, Suffix = "s", CurrentValue = config.bossSpeed, Callback = function(v) config.bossSpeed = v end })
bossTab:CreateLabel("Boss scan every 15 seconds")
bossTab:CreateLabel("Eco mode dobra o tempo se inativo")
bossTab:CreateSection("Boss List")
for _, name in ipairs(bossList) do
    bossTab:CreateToggle({
        Name = name,
        CurrentValue = bossEnabled[name],
        Callback = function(v) bossEnabled[name] = v end
    })
end

local sacrificeTab = win:CreateTab("Sacrifice")
sacrificeTab:CreateSection("SACRIFICE LOOP - 5 SECONDS")
sacrificeTab:CreateLabel("⚡ Limitado a 3 chamadas/segundo ⚡")
sacrificeTab:CreateLabel("• Cada pet tem seu próprio loop")
sacrificeTab:CreateLabel("• Botão Once funciona independente")
sacrificeTab:CreateLabel(" ")

sacrificeTab:CreateSection("SUMMER EVENT")
sacrificeTab:CreateToggle({ 
    Name = "Queen Bee (Mythical) - Loop", 
    CurrentValue = sacrificeLoopActive.queen, 
    Callback = function(v) 
        sacrificeLoopActive.queen = v
        toggleSacrificeLoop("Queen Bee", v)
    end 
})
sacrificeTab:CreateButton({ 
    Name = "Sacrifice Queen Bee (Once)", 
    Callback = function() 
        doSacrifice("Queen Bee")
    end 
})

sacrificeTab:CreateToggle({ 
    Name = "King Bee (Legendary) - Loop", 
    CurrentValue = sacrificeLoopActive.king, 
    Callback = function(v) 
        sacrificeLoopActive.king = v
        toggleSacrificeLoop("King Bee", v)
    end 
})
sacrificeTab:CreateButton({ 
    Name = "Sacrifice King Bee (Once)", 
    Callback = function() 
        doSacrifice("King Bee")
    end 
})

sacrificeTab:CreateSection("WINTER EVENT")
sacrificeTab:CreateToggle({ 
    Name = "Frozen Werewolf (Mythical) - Loop", 
    CurrentValue = sacrificeLoopActive.frozen, 
    Callback = function(v) 
        sacrificeLoopActive.frozen = v
        toggleSacrificeLoop("Frozen Werewolf", v)
    end 
})
sacrificeTab:CreateButton({ 
    Name = "Sacrifice Frozen Werewolf (Once)", 
    Callback = function() 
        doSacrifice("Frozen Werewolf")
    end 
})

sacrificeTab:CreateToggle({ 
    Name = "Walrus (Legendary) - Loop", 
    CurrentValue = sacrificeLoopActive.walrus, 
    Callback = function(v) 
        sacrificeLoopActive.walrus = v
        toggleSacrificeLoop("Walrus", v)
    end 
})
sacrificeTab:CreateButton({ 
    Name = "Sacrifice Walrus (Once)", 
    Callback = function() 
        doSacrifice("Walrus")
    end 
})

sacrificeTab:CreateSection("SPHINX EVENT")
sacrificeTab:CreateToggle({ 
    Name = "Fennec Fox (Mythical) - Loop", 
    CurrentValue = sacrificeLoopActive.fennec, 
    Callback = function(v) 
        sacrificeLoopActive.fennec = v
        toggleSacrificeLoop("Fennec Fox", v)
    end 
})
sacrificeTab:CreateButton({ 
    Name = "Sacrifice Fennec Fox (Once)", 
    Callback = function() 
        doSacrifice("Fennec Fox")
    end 
})

sacrificeTab:CreateToggle({ 
    Name = "Mystic Camel (Legendary) - Loop", 
    CurrentValue = sacrificeLoopActive.mystic, 
    Callback = function(v) 
        sacrificeLoopActive.mystic = v
        toggleSacrificeLoop("Mystic Camel", v)
    end 
})
sacrificeTab:CreateButton({ 
    Name = "Sacrifice Mystic Camel (Once)", 
    Callback = function() 
        doSacrifice("Mystic Camel")
    end 
})

local miscTab = win:CreateTab("Misc")
miscTab:CreateSection("Movement")
miscTab:CreateToggle({ Name = "Infinite Double Jump", CurrentValue = config.doubleJump, Callback = function(v)
    config.doubleJump = v
    if v then
        local humanoid = LocalPlayer.Character and LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
        if humanoid then
            humanoid:SetStateEnabled(Enum.HumanoidStateType.Jumping, true)
            jumpCount = 0
            if not jumpConnection then
                jumpConnection = humanoid.Jumping:Connect(function()
                    jumpCount = jumpCount + 1
                    if jumpCount >= 2 then
                        humanoid.Jump = true
                        jumpCount = 0
                    end
                end)
            end
        end
    elseif jumpConnection then
        jumpConnection:Disconnect()
        jumpConnection = nil
        jumpCount = 0
    end
end })

miscTab:CreateSlider({ Name = "Walk Speed", Range = {16, 100}, Increment = 1, Suffix = "", CurrentValue = config.wallspeed, Callback = function(v)
    config.wallspeed = v
    local humanoid = LocalPlayer.Character and LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
    if humanoid then
        humanoid.WalkSpeed = v
    end
end })

miscTab:CreateSection("Hotkey")
miscTab:CreateLabel("Press H to hide/show GUI")

local guiVisible = true
UserInputService.InputBegan:Connect(function(input, gp)
    if not gp and input.KeyCode == Enum.KeyCode.H then
        guiVisible = not guiVisible
        for _, v in pairs(win:GetChildren()) do
            if v:IsA("ScreenGui") then
                v.Enabled = guiVisible
            end
        end
    end
end)

game:GetService("StarterGui"):SetCore("SendNotification", {
    Title = "Maveryk Hub",
    Text = "Ultra Otimizado | Anti-Crash",
    Duration = 3
})
